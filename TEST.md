# OhMyCowork 功能测试计划

本文档包含所有工具的测试用例，请在应用中逐个测试。

---

## 自动化单元测试

单元测试已使用 Vitest 实现，共 111 个测试用例。

### 运行测试

```bash
# 进入 sidecar 目录
cd sidecar

# 运行所有测试
npm test

# 监听模式（文件变化时自动重新测试）
npm run test:watch

# 可视化 UI 界面
npm run test:ui

# 带覆盖率报告
npm run test:coverage
```

或者直接一行运行：
```bash
npm test --prefix sidecar
```

### 测试覆盖范围

| 测试文件 | 测试数 | 描述 |
|---------|-------|------|
| file_management.test.js | 18 | 文件搜索、重命名、复制、删除等 |
| archive_operations.test.js | 14 | ZIP/TAR/GZIP 压缩解压 |
| data_analysis.test.js | 13 | CSV 读取、统计、筛选、分组等 |
| image_operations.test.js | 12 | 图片缩放、裁剪、转换、滤镜等 |
| powerpoint_operations.test.js | 10 | PPT 创建、幻灯片、图表等 |
| format_conversion.test.js | 10 | JSON/CSV/YAML/Markdown 互转 |
| excel_operations.test.js | 9 | Excel 创建、读取、公式等 |
| word_operations.test.js | 9 | Word 创建、读取、转换等 |
| pdf_operations.test.js | 8 | PDF 创建、合并、水印等 |
| web_operations.test.js | 8 | HTML 解析、链接提取等 |
| **总计** | **111** | |

---

## 手动测试准备

1. 启动应用：`bun run tauri dev`
2. 选择一个测试工作区文件夹
3. 在工作区中准备以下测试文件：
   - 几个文本文件（.txt）
   - 一张图片（test.jpg 或 test.png）
   - 一个 CSV 文件（data.csv）
   - 一个 PDF 文件（test.pdf）
   - 一个视频文件（test.mp4，可选）

---

## 1. 核心工具

### 1.1 get_time
- [ ] **测试**: "现在几点了？"
- [ ] **预期**: 返回当前时间（ISO、本地时间、时间戳）

### 1.2 get_timezone
- [ ] **测试**: "我的时区是什么？"
- [ ] **预期**: 返回系统时区信息

### 1.3 random_number
- [ ] **测试**: "生成一个 1 到 100 之间的随机数"
- [ ] **预期**: 返回 1-100 范围内的随机整数

### 1.4 generate_uuid
- [ ] **测试**: "生成一个 UUID"
- [ ] **预期**: 返回 UUID v4 格式字符串

### 1.5 calculate_expression
- [ ] **测试**: "计算 (123 + 456) * 2 / 3"
- [ ] **预期**: 返回计算结果 386

### 1.6 run_node
- [ ] **测试**: "用 Node.js 计算斐波那契数列前 10 个数"
- [ ] **预期**: 返回 [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]

---

## 2. 文件管理

### 2.1 file_search
- [ ] **测试**: "搜索工作区中所有的 .txt 文件"
- [ ] **预期**: 返回匹配文件列表及元数据

- [ ] **测试**: "查找 src 目录下所有 .js 文件"
- [ ] **预期**: 返回匹配文件（如有）

### 2.2 file_rename
- [ ] **测试**: "把工作区中所有 .txt 文件添加前缀 'backup_'（先预览）"
- [ ] **预期**: 返回 dryRun 结果，显示将要重命名的文件

### 2.3 find_duplicates
- [ ] **测试**: "查找工作区中的重复文件"
- [ ] **预期**: 返回按哈希分组的重复文件列表

### 2.4 create_folders
- [ ] **测试**: "创建以下文件夹结构：project/src, project/tests, project/docs"
- [ ] **预期**: 成功创建文件夹，返回已创建列表

### 2.5 file_copy_move
- [ ] **测试**: "复制 test.txt 到 backup/test.txt"
- [ ] **预期**: 文件被复制，返回成功信息

### 2.6 file_delete
- [ ] **测试**: "删除 backup 文件夹（先预览）"
- [ ] **预期**: dryRun 显示将要删除的内容

### 2.7 organize_folder
- [ ] **测试**: "整理工作区根目录，把文件按类型分类"
- [ ] **预期**: 文件被移动到 Documents、Images、Code 等分类文件夹

---

## 3. Excel 电子表格

### 3.1 创建 Excel
- [ ] **测试**: "创建一个 Excel 文件 sales.xlsx，包含列：产品、数量、单价，添加 3 行示例数据"
- [ ] **预期**: 生成 sales.xlsx，包含表头和数据

### 3.2 读取 Excel
- [ ] **测试**: "读取 sales.xlsx 的内容"
- [ ] **预期**: 返回工作表名称、行数、数据预览

### 3.3 分析 Excel
- [ ] **测试**: "分析 sales.xlsx，统计每列的数据类型和数值统计"
- [ ] **预期**: 返回列分析（类型、计数、求和、平均值等）

### 3.4 添加工作表
- [ ] **测试**: "给 sales.xlsx 添加一个名为 'Summary' 的新工作表"
- [ ] **预期**: 成功添加新工作表

### 3.5 写入公式
- [ ] **测试**: "在 sales.xlsx 的 D2 单元格添加公式 =B2*C2"
- [ ] **预期**: 公式写入成功

### 3.6 CSV 转 Excel
- [ ] **测试**: "把 data.csv 转换成 Excel 文件 data.xlsx"
- [ ] **预期**: 生成 data.xlsx

### 3.7 Excel 转 CSV
- [ ] **测试**: "把 sales.xlsx 导出为 CSV 文件"
- [ ] **预期**: 生成 sales.csv

### 3.8 数据透视
- [ ] **测试**: "对 sales.xlsx 按产品分组，求数量的总和"
- [ ] **预期**: 返回透视结果

---

## 4. Word 文档

### 4.1 创建 Word
- [ ] **测试**: "创建一个 Word 文档 report.docx，标题是'月度报告'，包含一个段落和一个项目符号列表"
- [ ] **预期**: 生成格式正确的 Word 文档

### 4.2 读取 Word
- [ ] **测试**: "读取 report.docx 的文本内容"
- [ ] **预期**: 返回文档文本

### 4.3 Markdown 转 Word
- [ ] **测试**: "把以下 Markdown 转成 Word 文档：# 标题\n\n这是段落\n\n- 项目1\n- 项目2"
- [ ] **预期**: 生成带格式的 Word 文档

### 4.4 Word 转 HTML
- [ ] **测试**: "把 report.docx 转换成 HTML 文件"
- [ ] **预期**: 生成 report.html

### 4.5 添加页眉页脚
- [ ] **测试**: "给 report.docx 添加页眉'公司名称'和页脚页码"
- [ ] **预期**: 文档更新，包含页眉页脚

---

## 5. PowerPoint 演示

### 5.1 创建演示文稿
- [ ] **测试**: "创建一个 5 页的 PPT presentation.pptx，主题是'人工智能入门'"
- [ ] **预期**: 生成包含标题页和内容页的演示文稿

### 5.2 多种布局
- [ ] **测试**: "创建 PPT，第一页是标题页，第二页是两栏布局对比内容"
- [ ] **预期**: 生成不同布局的幻灯片

### 5.3 添加图表
- [ ] **测试**: "创建 PPT，包含一个销售数据的柱状图"
- [ ] **预期**: 生成带图表的幻灯片

---

## 6. PDF 操作

### 6.1 创建 PDF
- [ ] **测试**: "创建一个 PDF 文件 hello.pdf，包含标题'Hello World'和一段介绍文字"
- [ ] **预期**: 生成 PDF 文件

### 6.2 获取 PDF 信息
- [ ] **测试**: "获取 test.pdf 的信息（页数、作者等）"
- [ ] **预期**: 返回 PDF 元数据

### 6.3 提取文本
- [ ] **测试**: "提取 test.pdf 中的文本内容"
- [ ] **预期**: 返回 PDF 文本

### 6.4 合并 PDF
- [ ] **测试**: "把 hello.pdf 和 test.pdf 合并成 combined.pdf"
- [ ] **预期**: 生成合并后的 PDF

### 6.5 拆分 PDF
- [ ] **测试**: "从 combined.pdf 中提取第 1-2 页保存为 extract.pdf"
- [ ] **预期**: 生成只包含指定页的 PDF

### 6.6 添加水印
- [ ] **测试**: "给 test.pdf 添加水印'机密文件'"
- [ ] **预期**: PDF 每页显示水印

### 6.7 添加页码
- [ ] **测试**: "给 test.pdf 添加页码，格式为'第 X 页 / 共 Y 页'"
- [ ] **预期**: PDF 每页底部显示页码

### 6.8 旋转页面
- [ ] **测试**: "把 test.pdf 的第 1 页旋转 90 度"
- [ ] **预期**: 指定页面被旋转

---

## 7. 图像处理

### 7.1 获取图片信息
- [ ] **测试**: "获取 test.jpg 的尺寸和格式信息"
- [ ] **预期**: 返回宽度、高度、格式、文件大小等

### 7.2 调整大小
- [ ] **测试**: "把 test.jpg 调整为宽度 800 像素"
- [ ] **预期**: 生成调整后的图片

### 7.3 裁剪
- [ ] **测试**: "裁剪 test.jpg，从 (100,100) 开始，大小 200x200"
- [ ] **预期**: 生成裁剪后的图片

### 7.4 格式转换
- [ ] **测试**: "把 test.jpg 转换为 PNG 格式"
- [ ] **预期**: 生成 test.png

### 7.5 压缩
- [ ] **测试**: "压缩 test.jpg，质量设为 60%"
- [ ] **预期**: 生成压缩后的图片，显示压缩比

### 7.6 旋转
- [ ] **测试**: "把 test.jpg 旋转 90 度"
- [ ] **预期**: 生成旋转后的图片

### 7.7 模糊
- [ ] **测试**: "给 test.jpg 添加模糊效果"
- [ ] **预期**: 生成模糊图片

### 7.8 灰度
- [ ] **测试**: "把 test.jpg 转为灰度图"
- [ ] **预期**: 生成黑白图片

### 7.9 水印
- [ ] **测试**: "给 test.jpg 添加文字水印'Sample'"
- [ ] **预期**: 图片显示水印文字

### 7.10 缩略图
- [ ] **测试**: "为 test.jpg 创建 200x200 的缩略图"
- [ ] **预期**: 生成智能裁剪的缩略图

---

## 8. 视频处理

> 需要系统安装 FFmpeg

### 8.1 获取视频信息
- [ ] **测试**: "获取 test.mp4 的视频信息"
- [ ] **预期**: 返回时长、分辨率、编码、帧率等

### 8.2 裁剪视频
- [ ] **测试**: "从 test.mp4 截取 0-10 秒的片段"
- [ ] **预期**: 生成 10 秒的视频片段

### 8.3 提取帧
- [ ] **测试**: "从 test.mp4 每秒提取 1 帧图片"
- [ ] **预期**: 生成多张 PNG 图片

### 8.4 提取音频
- [ ] **测试**: "从 test.mp4 提取音频保存为 MP3"
- [ ] **预期**: 生成 audio.mp3

### 8.5 调整分辨率
- [ ] **测试**: "把 test.mp4 调整为 720p 分辨率"
- [ ] **预期**: 生成 1280x720 的视频

### 8.6 压缩视频
- [ ] **测试**: "压缩 test.mp4，使用中等质量"
- [ ] **预期**: 生成较小的视频文件

### 8.7 转 GIF
- [ ] **测试**: "把 test.mp4 的前 5 秒转成 GIF"
- [ ] **预期**: 生成动画 GIF

### 8.8 格式转换
- [ ] **测试**: "把 test.mp4 转换为 WebM 格式"
- [ ] **预期**: 生成 test.webm

---

## 9. 数据分析

> 准备测试用 CSV 文件 (data.csv)：
> ```csv
> name,age,city,salary
> Alice,30,Beijing,50000
> Bob,25,Shanghai,45000
> Charlie,35,Beijing,60000
> David,28,Guangzhou,48000
> Eve,32,Shanghai,55000
> ```

### 9.1 读取 CSV
- [ ] **测试**: "读取 data.csv 的内容"
- [ ] **预期**: 返回行数、列名、数据预览

### 9.2 数据描述
- [ ] **测试**: "描述 data.csv 的结构和每列的统计信息"
- [ ] **预期**: 返回每列的类型、空值数、唯一值数、数值统计

### 9.3 列统计
- [ ] **测试**: "计算 data.csv 中 salary 列的统计信息（均值、中位数、标准差）"
- [ ] **预期**: 返回详细统计指标

### 9.4 筛选数据
- [ ] **测试**: "筛选 data.csv 中 age 大于 30 的记录"
- [ ] **预期**: 返回符合条件的行

### 9.5 排序
- [ ] **测试**: "按 salary 降序排列 data.csv"
- [ ] **预期**: 返回排序后的数据

### 9.6 分组聚合
- [ ] **测试**: "按 city 分组，计算每个城市的平均 salary"
- [ ] **预期**: 返回分组统计结果

### 9.7 相关性分析
- [ ] **测试**: "计算 data.csv 中 age 和 salary 的相关系数"
- [ ] **预期**: 返回相关性矩阵

### 9.8 异常值检测
- [ ] **测试**: "检测 data.csv 中 salary 列的异常值（使用 Z-score 方法）"
- [ ] **预期**: 返回异常值列表（如有）

### 9.9 数据透视
- [ ] **测试**: "对 data.csv 按 city 透视，求 salary 的总和"
- [ ] **预期**: 返回透视表结果

### 9.10 数据转换
- [ ] **测试**: "对 data.csv 的 salary 列进行标准化处理"
- [ ] **预期**: 返回添加了标准化列的数据

---

## 10. 压缩归档

### 10.1 创建 ZIP
- [ ] **测试**: "把 project 文件夹压缩成 project.zip"
- [ ] **预期**: 生成 ZIP 文件

### 10.2 解压 ZIP
- [ ] **测试**: "解压 project.zip 到 extracted 文件夹"
- [ ] **预期**: 文件被解压到指定目录

### 10.3 列出 ZIP 内容
- [ ] **测试**: "列出 project.zip 中的文件"
- [ ] **预期**: 返回文件列表

### 10.4 创建 TAR.GZ
- [ ] **测试**: "把 project 文件夹打包成 project.tar.gz"
- [ ] **预期**: 生成 tar.gz 文件

### 10.5 解压 TAR
- [ ] **测试**: "解压 project.tar.gz"
- [ ] **预期**: 文件被解压

### 10.6 GZIP 压缩
- [ ] **测试**: "用 GZIP 压缩 data.csv"
- [ ] **预期**: 生成 data.csv.gz

### 10.7 GZIP 解压
- [ ] **测试**: "解压 data.csv.gz"
- [ ] **预期**: 恢复原文件

---

## 11. 网络操作

### 11.1 HTTP GET
- [ ] **测试**: "获取 https://httpbin.org/get 的内容"
- [ ] **预期**: 返回 HTTP 响应

### 11.2 HTTP POST
- [ ] **测试**: "向 https://httpbin.org/post 发送 POST 请求，body 为 {\"name\": \"test\"}"
- [ ] **预期**: 返回 POST 响应

### 11.3 解析 HTML
- [ ] **测试**: "获取 https://example.com 并提取页面标题"
- [ ] **预期**: 返回页面标题

### 11.4 提取链接
- [ ] **测试**: "提取 https://example.com 页面中的所有链接"
- [ ] **预期**: 返回链接列表

### 11.5 解析 RSS
- [ ] **测试**: "解析 https://feeds.bbci.co.uk/news/rss.xml RSS 订阅"
- [ ] **预期**: 返回 RSS 条目列表

### 11.6 下载文件
- [ ] **测试**: "下载 https://via.placeholder.com/150 保存为 placeholder.png"
- [ ] **预期**: 图片下载到工作区

### 11.7 JSON API
- [ ] **测试**: "调用 https://jsonplaceholder.typicode.com/todos/1 API"
- [ ] **预期**: 返回 JSON 数据结构

---

## 12. 格式转换

### 12.1 图片格式转换
- [ ] **测试**: "把 test.jpg 转换为 WebP 格式"
- [ ] **预期**: 生成 test.webp

### 12.2 Markdown → HTML
- [ ] **测试**: "把以下 Markdown 转成 HTML：# Hello\n\nWorld"
- [ ] **预期**: 返回 HTML 代码

### 12.3 Markdown → DOCX
- [ ] **测试**: "把 README.md 转换成 Word 文档"
- [ ] **预期**: 生成 Word 文档

### 12.4 HTML → Markdown
- [ ] **测试**: "把 '<h1>Title</h1><p>Content</p>' 转成 Markdown"
- [ ] **预期**: 返回 Markdown 格式

### 12.5 JSON → CSV
- [ ] **测试**: "把 [{\"a\":1,\"b\":2},{\"a\":3,\"b\":4}] 转成 CSV"
- [ ] **预期**: 返回 CSV 格式

### 12.6 CSV → JSON
- [ ] **测试**: "把 data.csv 转成 JSON 格式"
- [ ] **预期**: 返回 JSON 数组

### 12.7 JSON → YAML
- [ ] **测试**: "把 {\"name\":\"test\",\"value\":123} 转成 YAML"
- [ ] **预期**: 返回 YAML 格式

### 12.8 YAML → JSON
- [ ] **测试**: "把 'name: test\nvalue: 123' 转成 JSON"
- [ ] **预期**: 返回 JSON 对象

### 12.9 Text → Base64
- [ ] **测试**: "把 'Hello World' 编码为 Base64"
- [ ] **预期**: 返回 SGVsbG8gV29ybGQ=

### 12.10 Base64 → Text
- [ ] **测试**: "把 'SGVsbG8gV29ybGQ=' 解码"
- [ ] **预期**: 返回 Hello World

---

## 13. 浏览器自动化

### 13.1 打开页面
- [ ] **测试**: "用浏览器打开 https://example.com"
- [ ] **预期**: 浏览器打开页面

### 13.2 截图
- [ ] **测试**: "打开 https://example.com 并截图保存为 screenshot.png"
- [ ] **预期**: 生成网页截图

---

## 14. 网络搜索（需要 Tavily API Key）

### 14.1 网络搜索
- [ ] **测试**: "搜索'人工智能最新进展'"
- [ ] **预期**: 返回搜索结果列表

---

## 测试结果汇总

| 类别 | 总数 | 通过 | 失败 | 跳过 |
|------|------|------|------|------|
| 核心工具 | 6 | | | |
| 文件管理 | 7 | | | |
| Excel | 8 | | | |
| Word | 5 | | | |
| PowerPoint | 3 | | | |
| PDF | 8 | | | |
| 图像 | 10 | | | |
| 视频 | 8 | | | |
| 数据分析 | 10 | | | |
| 压缩归档 | 7 | | | |
| 网络操作 | 7 | | | |
| 格式转换 | 10 | | | |
| 浏览器 | 2 | | | |
| 网络搜索 | 1 | | | |
| **总计** | **92** | | | |

---

## 测试注意事项

1. **视频处理**需要系统安装 FFmpeg
2. **网络搜索**需要配置 Tavily API Key
3. **浏览器自动化**需要运行 `bun run install:browser` 安装依赖
4. 文件操作都使用工作区相对路径（如 `/test.txt`）
5. 某些操作支持 `dryRun` 预览模式，建议先预览再执行

## 报告问题

如果测试失败，请记录：
1. 测试用例编号
2. 输入的命令
3. 实际输出
4. 错误信息（如有）
